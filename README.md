
## Запуск

3. Установить виртуальное окружение:
```bash
python -m venv venv
```
4. Запустить окружение:
```bash
venv/scripts/activate
```
5. Установить зависимости:
```bash
pip install -r requirements.txt
```
6. Запустить приложение, передав необходимые параметры:
```bash
python app.py --password <PASS> --token <TOKEN> --uri <URI> --user <USER> --host <HOST> --port <PORT>
```

**Параметры:**
--password — Пароль пользователя Neo4j (обязательный)
--token — Токен авторизации FastAPI (обязательный)
--uri — URI подключения к Neo4j
--user — Имя пользователя Neo4j
--host — Хост для запуска
--port — Порт для запуска

### Примеры:
```bash
python app.py --token aaabbb --password 11111111
```

### Эндпоинты:

- **GET /user/{user_id}** - возвращает информацию о пользователе по его user_id.  
Параметры пути:  
user_id (str): ID пользователя.  
Ответ: информация о пользователе (id, name, screen_name, sex, city).  

- **GET /top-users** - возвращает топ-5 пользователей с наибольшим количеством подписчиков.  
Ответ: список пользователей (id, name, followers_count).  

- **GET /top-groups** - возвращает топ-5 групп с наибольшим количеством подписчиков.  
Ответ: список групп (id, name, subscribers_count).  

- **GET /users-count** - возвращает общее количество пользователей.  
Ответ: количество пользователей (users_count).  

- **GET /groups-count** - возвращает общее количество групп.  
Ответ: количество групп (groups_count).  

- **GET /nodes** - возвращает список всех узлов в базе данных с их метками и ID.  
Ответ: список узлов (id, label).  

- **GET /node/{label}/{node_id}** - возвращает узел с его связями и атрибутами по метке label и ID узла.  
Параметры пути:  
label (str): метка узла (например, User, Group).  
node_id (int): ID узла.  
Ответ: узел (label, attributes), список связей (relationship, related_node).  

- **POST /nodes** - создает новый узел и связи к нему.  
Тело запроса (пример):  
```bash
{  
  "id": 11111111,  
  "label": "User",  
  "name": "Chel Chelikovich",  
  "sex": 1,  
  "city": "Тюмень",  
  "screen_name": "chelikkkkk_chel",  
  "follows": [11111111, 506443521],  
  "subscribed": [178256900, 34491914]  
}  
```
Ответ: статус создания.  
**ЭТОТ ЭНДПОИНТ ИСПОЛЬЗУЕТ АУТЕНТИФИКАЦИЮ**

- **DELETE /nodes/{label}/{node_id}** - удаляет узел и все связанные с ним отношения.  
Параметры пути:  
label (str): метка узла (например, User, Group).  
node_id (int): ID узла.  
Ответ: статус удаления.  
**ЭТОТ ЭНДПОИНТ ИСПОЛЬЗУЕТ АУТЕНТИФИКАЦИЮ**

### Тесты:

**ЗАПУСК:**
```bash
pytest test_app.py
```
- **test_get_user:** Проверяет получение пользователя по ID. Отправляет GET запрос на "/user/12345" с токеном в заголовке и проверяет, что ответ содержит правильные данные пользователя.

- **test_get_top_users:** Проверяет получение топовых пользователей. Отправляет GET запрос на "/top-users" и проверяет, что ответ является списком с кодом 200.

- **test_get_top_groups:** Проверяет получение топовых групп. Отправляет GET запрос на "/top-groups" и проверяет, что ответ является списком с кодом 200.

- **test_get_users_count:** Проверяет получение количества пользователей. Отправляет GET запрос на "/users-count" и проверяет, что ответ содержит ключ "users_count" с кодом 200.

- **test_get_groups_count:** Проверяет получение количества групп. Отправляет GET запрос на "/groups-count" и проверяет, что ответ содержит ключ "groups_count" с кодом 200.

- **test_get_all_nodes:** Проверяет получение всех узлов. Отправляет GET запрос на "/nodes" и проверяет, что ответ является списком с кодом 200.

- **test_delete_node_and_relations:** Проверяет удаление узла и всех его связей. Отправляет GET запрос на "/user/12345", затем DELETE запрос на "/nodes/User/12345", проверяя успешность удаления с кодом 200 и отсутствие пользователя с кодом 404 после удаления.